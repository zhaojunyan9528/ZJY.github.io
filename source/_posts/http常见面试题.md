---
title: http常见面试题
tags:
  - 前端
categories:
  - - 面试
    - Javascript
date: 2021-02-05 14:33:46
---

## 1.HTTP基本概念

### 1.1 http是什么？
http是超文本传输协议，也就是HyperText Transfer Protocaol。
+ 协议
    + http是一个用在计算机世界里的协议。它使用计算机能够理解的语言确立了一种计算机之间交流通信的规范，以及相关的各种控制和错误处理方式
+ 传输
    + http协议是一个双向协议
    + http是一个在计算机世界里专门用来在两点之间传输数据的约定和规范
        我们在上网冲浪时，浏览器是请求方 A ，百度网站就是应答方 B。双方约定用 HTTP 协议来通信，于是浏览器把请求数据发送给网站，网站再把一些数据返回给浏览器，最后由浏览器渲染在屏幕，就可以看到图片、视频了。
        数据虽然是在 A 和 B 之间传输，但允许中间有中转或接力。
        就好像第一排的同学想穿递纸条给最后一排的同学，那么传递的过程中就需要经过好多个同学（中间人），这样的传输方式就从「A < --- > B」，变成了「A <-> N <-> M <-> B」。
        而在 HTTP 里，需要中间人遵从 HTTP 协议，只要不打扰基本的数据传输，就可以添加任意额外的东西。
+ 超文本
    + http传输的内容是超文本
    + 我们先来理解「文本」，在互联网早期的时候只是简单的字符文字，但现在「文本」的涵义已经可以扩展为图片、视频、压缩包等，在 HTTP 眼里这些都算做「文本」
    + 再来理解「超文本」，它就是超越了普通文本的文本，它是文字、图片、视频等的混合体最关键有超链接，能从一个超文本跳转到另外一个超文本
    + HTML 就是最常见的超文本了，它本身只是纯文字文件，但内部用很多标签定义了图片、视频等的链接，在经过浏览器的解释，呈现给我们的就是一个文字、有画面的网页了

<b>HTTP 是一个在计算机世界里专门在「两点」之间「传输」文字、图片、音频、视频等「超文本」数据的「约定和规范」。</b>

### 1.2 「HTTP 是用于从互联网服务器传输超文本到本地浏览器的协议HTTP」,这种说法正确吗？

这种说法是不正确的。因为也可以是「服务器< -- >服务器」，所以采用两点之间的描述会更准确

### 1.3 http常见的状态吗有哪些？
+ 1xx
    + 1xx类状态码属于提示信息，是协议处理中的一种中间状态，实际用到的比较少
+ 2xx
    + 2xx类状态码表示服务器成功处理了客户端的请求。
    + 200 ok是最常见的成功状态码，表示一切正常。如果是非HEAD请求，服务器返回的相应头都会有body数据。
    + 204 no content也是常见的成功状态码，与200基本相同，但响应头没有body数据。
    + 206 partial content是应用于http分块下载或断电续传。表示响应返回的body数据并不是资源的全部，而是其中的一部分，也是服务器处理成功的状态。
+ 3xx
    + 3xx类状态码表示客户端请求的资源发生了变动，需要客户端用新的URL重新发送请求获取资源，也就是重定向。
    + 301 Moved Permanently 表示永久重定向，说明请求的资源已经不在了，需要用另一个url再次访问
    + 302 临时重定向，说明请求的资源还在，但暂时需要用另一个url来访问
    + 301和302都会在响应头里使用字段location，指明后续要跳转的url，浏览器会自动重定向新的url。
    + 304 not modified不具有跳转的含义，表示资源未被修改，重定向已存在的缓冲文件，也称为缓存重定向，用于缓存控制。
+ 4xx
    + 4xx类状态码表示客户端发送的报文有误，服务器无法处理，也就是错误码的含义。
    + 400 bad request表示客户端请求的报文有误，但只是个笼统的错误
    + 403 forbidden表示服务器禁止访问资源，并不是客户端的请求出错
    + 404 not found表示请求的资源在服务器上不存在或未找到，所以无法提供给客户端。
+ 5xx
    + 5xx类状态码表示客户端请求报文正确，但服务器处理时内部发生了错误，属于服务端的错误码。
    + 500 internal server error，与 400 类型，是个笼统通用的错误码，服务器发生了什么错误，我们并不知道。
    + 501 not implemented 表示客户端请求的功能还不支持，类似“即将开业，敬请期待”的意思。
    + 502 bad gateway，通常是服务器作为网关或代理时返回的错误码，表示服务器自身工作正常，访问后端服务器发生了错误
    + 503 service unavailable表示服务器当前很忙，暂时无法响应服务器。

### 1.4 http常见字段有哪些？

+ Host
    + 客户端发送请求时，用来指定服务器的域名
    + host:http:www.a.com
    + 有了host字段，就可以将请求发往同一台服务器的不同网站
+ Content-Length
    + 服务器在返回数据时，会有content-length字段，表明本次回应的数据长度
+ Connection字段
    + Connection字段最常用于客户端要求服务器使用TCP持久连接，以便其他请求复用。Connection: keep-alive
+ Content-Type字段
    + Content-Type字段用于服务器返回时，告诉客户端本次数据返回什么格式。
    + Content-Type: text/html; charset=utf-8
    + 上面的类型表明，发送的是网页，而且编码是UTF-8
    + 客户端请求的时候，可以使用 Accept 字段声明自己可以接受哪些数据格式
    + Accept: */*
    + 上面代码中，客户端声明自己可以接受任何格式的数据。
+ Content-Encoding字段
    + Content-Encoding 字段说明数据的压缩方法。表示服务器返回的数据使用了什么压缩格式
    + Content-Encoding: gzip
    + 上面表示服务器返回的数据采用了 gzip 方式压缩，告知客户端需要用此方式解压。
    + 客户端在请求时，用 Accept-Encoding 字段说明自己可以接受哪些压缩方法
    + Accept-Encoding: gzip, deflate

## 2.GET和POST

### 2.1get和post的区别？

+ get方法含义是请求从服务器获取资源，这个资源可以是静态的文本、页面、图片视频等。比如打开一篇文章，浏览器会发送get请求给服务器，服务器就会返回文章所有资源。
+ post方法向url指定的资源提交数据，数据就放在报文的body里。比如在一篇文章底部，提交留言板，浏览器就会执行一次post请求，把你的留言文字放进报文body里然后拼接好post请求，通过tcp协议发送给服务器。

### 2.2 get和post 方法都是安全和幂等的吗？

+ 安全：在http协议里，所谓的安全是指请求方法不会破坏服务器上的资源。
+ 幂等：多次执行相同的操作，结果都是相同的。
+ get方法就是安全且幂等的，因为它是只读操作，无论操作多少次，服务器上的数据是安全的，且每次的结果都是相同的。
+ post是新增或提交数据的操作，会修改服务器上的资源，所以是不安全的，且多次提交数据就会创建多个资源，所以不是幂等的。

## 3.http的特性

### 3.1 你知道的 HTTP（1.1） 的优点有哪些，怎么体现的？

http最凸出的优点是简单、灵活和易于扩展、应用广泛和跨平台。
+ 简单：http最基本的报文格式是header+body，头部信息也是key-value简单文本的形式。易于理解降低学习和使用门槛。
+ 灵活和易于扩展：
    + http协议里的各类请求方法、URL/URI、状态码、头字段等每个组成要求都没被固定死，都允许开发人员自定义和扩展。
    + http工作在应用层，则它下层可以随意变化
    + HTTPS 也就是在 HTTP 与 TCP 层之间增加了 SSL/TLS 安全传输层，HTTP3 甚至把 TCPP 层换成了基于 UDP 的 QUIC。
+ 应用广泛和跨平台

### 3.2 http的缺点？

http协议里有优缺点一体的双刃剑，分别是无状态、明文传输，同时还有一大缺点不安全。
+ 无状态双刃剑
    + 无状态的好处，因为服务器不会去记忆http的状态，所以不需要额外的资源来记录状态信息，这可以减轻服务器的压力，能够把更多的cpu和内存用于对外提供服务
    + 无状态的坏处，既然服务器没有记忆能力，在完成关联性的操作时会非常麻烦。例如登录->添加购物车->下单->结算->支付，这系列操作都要知道用户的身份才行。但服务器不知道这些请求是有关联的，每次都要问一遍身份信息
+ 明文传输双刃剑
    + 明文传输是在传输信息过程中，是可方便阅读的，在浏览器控制台和抓包可以直接肉眼查看，为开发者调试工作带来了便利。
    + 但是就是因为这样，信息都暴露出来，容易泄漏，很容易被窃取。
+ 不安全
    + 通信使用明文，不加密，信息很容易被窃取。
    + 不验证通信方的身份，很可能遭遇伪装，比如访问假的淘宝，京东
    + 无法证明报文的完整性，所以有可能已遭篡改，比如网页植入广告
    + HTTP 的安全问题，可以用 HTTPS 的方式解决，也就是通过引入 SSL/TLS 层，使得在安全上达到了极致。

### 3.3 http1.1的性能？

http协议是基于TCP/IPP，并且使用了请求-应答的通信模式，所以性能的关键就在这2点里。
+ 长连接
    + 早期http1.0性能上很大一个问题就是每发起一个请求，都要重新建立一次TCP连接（三次握手），而且是串行请求，做了无谓的TCP连接建立和断开，增加了通信的开销
    + 为了解决上述的TCP连接问题，http1.1提出了长连接的通信方式，也叫持久连接。这种方式的好处在于减少了TCP连接的重复建立和断开所造成的额外开销，减轻了服务器的负载。
    + 持久连接的特点是，只要任意一端没有明确说明断开连接则保持TCP连接状态。
+ 管道网络传输
    + HTTP/1.1 采用了长连接的方式，这使得管道（pipeline）网络传输成为了可能。
    + 即在同一个TCP连接里，可发起多个请求，只要第一个请求发出去了，不必等其回来，就可发第二个请求出去，可以减少整体的响应时间。
    + 举例来说，客户端需要请求两个资源。以前的做法是，在同一个TCP连接里面，先发送 A 请求，然后等待服务器做出回应，收到后再发出 B 请求。管道机制则是允许浏览器同时发出 A 请求和 B 请求
    + 但是服务器还是按照顺序，先回应 A 请求，完成后再回应 B 请求。要是 前面的回应特别慢，后面就会有许多请求排队等着。这称为「队头堵塞」。
+ 队头堵塞
    + 请求 - 应答的模式，加剧了http的性能问题。
    + 因为当顺序发送的请求序列中的一个请求因为某种原因被阻塞时，会导致后面的请求也被阻塞，客户端一直请求不到数据，这也就是对头阻塞。
    + 总之 HTTP/1.1 的性能一般般，后续的 HTTP/2 和 HTTP/3 就是在优化 HTTP 的性能

## 4.http和https

### 4.1 HTTP 与 HTTPS 有哪些区别？

+ http是超文本传输协议，信息是明文传输，存在安全隐患。https则解决了http不安全的问题，在TCP和HTTP网络层之间加入了SSL/TLS安全协议，使得报文能够加密传输。
+ http连接建立相对简单，TCP三次握手后就可进行http报文传输。而https在TCP三次握手之后，还需要进行SSL/TLS的握手过程，才可进入报文加密传输。
+ http的端口是80，https的端口是443
+ https需要向CA（证书权威机构）申请数字证书，来保证服务器的身份是可信的。

### 4.2 HTTPS解决了http的哪些问题？

+ HTTP 由于是明文传输，所以安全上存在以下三个风险：
    + 窃听风险，比如通信链路上可以获取通信内容，用户号容易没。
    + 篡改风险，比如强制入垃圾广告，视觉污染，用户眼容易瞎。
    + 冒充风险，比如冒充淘宝网站，用户钱容易没。
+ HTTPS 在 HTTP 与 TCP 层之间加入了 SSL/TLS 协议。
    + HTTP TCP IP MAC
    + HTTP SSL/TLS TCP IP MAC
+ HTTP 与 HTTPS可以很好的解决了上述的风险：
    + 信息加密：交互信息无法被窃取
    + 校验机制：无法篡改通信内容，篡改了就不能正常显示
    + 身份证书：证明淘宝是真的淘宝网
+ HTTPS 是如何解决上面的三个风险的？
    + 混合加密的方式实现信息的机密性，解决了窃听的风险
    + 摘要算法的方式来实现完整性，它能够为数据生成独一无二的指纹，用于校验数据的完整性，解决来篡改的风险
    + 将服务器公钥放进数字证书里，解决里冒充的风险。

## 5.HTTP/1.1、HTTP/2、HTTP/3 演变

### 5.1 HTTP/1.1 相比 HTTP/1.0 提高了什么性能？
+ HTTP/1.1 相比 HTTP/1.0 性能上的改进：
    + 使用 TCP 长连接的方式改善了 HTTP/1.0 短连接造成的性能开销。
    + 支持 管道（pipeline）网络传输，只要第一个请求发出去了，不必等其回来，就可以发第二个请求出去，可以减少整体的响应时间
+ 但 HTTP/1.1 还是有性能瓶颈：
    + 请求 / 响应头部（Header）未经压缩就发送，首部信息越多延迟越大。只能压缩 Body 的部分
    + 发送冗长的首部。每次互相发送相同的首部造成的浪费较多
    + 服务器是按请求的顺序响应的，如果服务器响应慢，会招致客户端一直请求不到数据，也就是队头阻塞；
    + 没有请求优先级控制；
    + 请求只能从客户端开始，服务器只能被动响应

### 5.2 基于上面的 HTTP/1.1 的性能瓶颈，HTTP/2 做了什么优化？

+ HTTP/2 协议是基于 HTTPS 的，所以 HTTP/2 的安全性也是有保障的。
+ 那 HTTP/2 相比 HTTP/1.1 性能上的改进：
    + 头部压缩
        + HTTP/2 会压缩头（Header）如果你同时发出多个请求，他们的头是一样的或是相似的，那么，协议会帮你消除重复的分。
        + 这就是所谓的 HPACK 算法：在客户端和服务器同时维护一张头信息表，所有字段都会存入这个表，生成一个索引号，以后就不发送同样字段了，只发送索引号，这样就提高速度了。
    + 二进制格式
        + HTTP/2 不再像 HTTP/1.1 里的纯文本形式的报文，而是全面采用了二进制格式。
        + 头信息和数据体都是二进制，并且统称为帧（frame）：头信息帧和数据帧
        + 这样虽然对人不友好，但是对计算机非常友好，因为计算机只懂二进制，那么收到报文后，无需再将明文的报文转成二进制，而是直接解析二进制报文，这增加了数据传输的效率。
    + 数据流
        + HTTP/2 的数据包不是按顺序发送的，同一个连接里面连续的数据包，可能属于不同的回应。因此，必须要对数据包做标记，指出它属于哪个回应。
        + 每个请求或回应的所有数据包，称为一个数据流（Stream）。
        + 每个数据流都标记着一个独一无二的编号，其中规定客户端发出的数据流编号为奇数， 服务器发出的数据流编号为偶数
        + 客户端还可以指定数据流的优先级。优先级高的请求，服务器就先响应该请求
    + 多路复用
        + HTTP/2 是可以在一个连接中并发多个请求或回应，而不用按照顺序一一对应。
        + 移除了 HTTP/1.1 中的串行请求，不需要排队等待，也就不会再出现「队头阻塞」问题，降低了延迟，大幅度提高了连接的利用率。
        + 举例来说，在一个 TCP 连接里，服务器收到了客户端 A 和 B 的两个请求，如果发现 A 处理过程非常耗时，于是就回应 A 请求已经处理好的部分，接着回应 B 请求，完成后，再回应 A 请求剩下的部分。
    + 服务器推送
        + HTTP/2 还在一定程度上改善了传统的「请求 - 应答」工作模式，服务不再是被动地响应，也可以主动向客户端发送消息。
        + 举例来说，在浏览器刚请求 HTML 的时候，就提前把可能会用到的 JS、CSS 文件等静态资源主动发给客户端，减少延时的等待，也就是服务器推送（Server Push，也叫 Cache Push）。

### 5.3 HTTP/2 有哪些缺陷？HTTP/3 做了哪些优化？

+ HTTP/2 主要的问题在于：多个 HTTP 请求在复用一个 TCP 连接，下层的 TCP 协议是不知道有多少个 HTTP 请求的。
+ 所以一旦发生了丢包现象，就会触发 TCP 的重传机制，这样在一个 TCP 连接中的所有的 HTTP 请求都必须等待这个丢了的包被重传回来。
    + HTTP/1.1 中的管道（ pipeline）传输中如果有一个请求阻塞了，那么队列后请求也统统被阻塞住了
    + HTTP/2 多请求复用一个TCP连接，一旦发生丢包，就会阻塞住所有的 HTTP 请求。
+ 这都是基于 TCP 传输层的问题，所以 HTTP/3 把 HTTP 下层的 TCP 协议改成了 UDP！
![image](/images/http.jpg)